* Reproduce KA literature results
:PROPERTIES:
:tangle: ka.sh
:END:

Simulate a 256-particle Kob-Andersen LJ mixture at temperature T=0.6
#+begin_src sh
  launch -c python ../bin/tps.py -T 0.6 --field 0.00 --steps 1000 -t 90.0 -i ../data/ka_rho1.2_T0.6.xyz '/tmp/tps/ka/s{field:.3f}/output'
  launch -c python ../bin/tps.py -T 0.6 --field 0.02 --steps 2000 -t 90.0 -i ../data/ka_rho1.2_T0.6.xyz '/tmp/tps/ka/s{field:.3f}/output'
  launch -c python ../bin/tps.py -T 0.6 --field 0.04 --steps 4000 -t 90.0 -i ../data/ka_rho1.2_T0.6.xyz '/tmp/tps/ka/s{field:.3f}/output'
  launch -c python ../bin/tps.py -T 0.6 --field 0.08 --steps 8000 -t 90.0 -i ../data/ka_rho1.2_T0.6.xyz '/tmp/tps/ka/s{field:.3f}/output'
#+end_src

#+results:
| Your | job | 125883 | python_.bin_tps.py_T_0.6_field_0.00_steps_1000_t_90.0_i_.data_ka_rho1.2_T0.6.xyz__tmp_tps_ka_s{field | has | been | submitted |
| Your | job | 125884 | python_.bin_tps.py_T_0.6_field_0.02_steps_2000_t_90.0_i_.data_ka_rho1.2_T0.6.xyz__tmp_tps_ka_s{field | has | been | submitted |
| Your | job | 125885 | python_.bin_tps.py_T_0.6_field_0.04_steps_4000_t_90.0_i_.data_ka_rho1.2_T0.6.xyz__tmp_tps_ka_s{field | has | been | submitted |
| Your | job | 125886 | python_.bin_tps.py_T_0.6_field_0.08_steps_8000_t_90.0_i_.data_ka_rho1.2_T0.6.xyz__tmp_tps_ka_s{field | has | been | submitted |

Collect and average data
#+begin_src sh
  {
  for f in /tmp/tps/ka/s* ; do
      echo $(grep -E '^# field' $f/output.log | cut -d : -f 2 | tail -n 1) \
           $(awk '(!/#/&&(NR>200)){print $4}' $f/output.thermo | ave)
  done
  } > /tmp/tps/ka/K_s.txt
#+end_src

#+results:

#+begin_src sh :tangle .defaults.gp
  reset
      
  set term pngcairo font 'Helvetica, 9' #size 700,340
  set ytics nomirror offset 0.3,0 scale 0.5
  set xtics nomirror offset 0,0.3 scale 0.5
  
  # Put borders in "the background", http://www.gnuplotting.org/tag/terminal
  set style line 11 lc rgb '#808080' lt 1
  set border 3 back # ls 11
  
  # Colors
  red="#D87791"
  red_dark="#B11B2B"
  red_dark="#B11B2B"  # from gnuplotting
  blue="#94B3DA"
  blue="#0060ad"  # from gnuplotting
  blue_dark="#3360B1"
  gray="gray60"
  black="gray20"
  green_dark="#5e9c36"  # gnuplotting 
  green="#60A36E"
  green_dark="#237634"
  orange="#E48100"
  orange_dark="#D74700"
 
  pscale = 1
  set style line 1 pt 7  lt 1 ps pscale*1.1 lw 1.5 lc rgb blue
  set style line 2 pt 5  lt 1 ps pscale*1   lw 1.5 lc rgb green_dark
  set style line 3 pt 13 lt 1 ps pscale*1.2 lw 1.5 lc rgb red_dark
  set style line 4 pt 6  lt 1 ps pscale*1.1 lw 1.5 lc rgb orange
  set style line 5 pt 4  lt 1 ps pscale*1   lw 1.5 lc rgb black
  set style line 6 pt 12 lt 1 ps pscale*1.2 lw 1.5 lc rgb gray
  set style line 7 pt 12 lt 1 ps pscale*1.2 lw 1.5 lc "purple"
  
  # Trick to get these line styles as the default styles
  # https://stackoverflow.com/questions/24800244/predefined-point-types-in-gnuplot
  set style increment user
#+end_src

#+results:

Plot the mobility during the simulation and as a function of the field
#+begin_src gnuplot :file /tmp/ka_s.png :tangle no
  load ".defaults.gp"
  set xl 'Steps'
  set yl 'K / (N t_{obs})'
  set xr [:]
  set yr [0.025:0.05]
  set key top left Left reverse spacing 1 
  set multi layout 1,2
  p for [s in "0.000 0.020 0.040 0.080"] '/tmp/tps/ka/s'.s.'/output.thermo' u 1:($4) ps 0.7 ti 's='.s w lp
  unset key
  set xl 'Field, s'
  set yl '< K / (N t_{obs}) >'
  p '/tmp/tps/ka/K_s.txt' u 1:2:($3*$4**0.5) ps 1.5 w err
  unset multi
#+end_src

#+results:
[[file:/tmp/ka_s.png]]


